/*!
 *  build: vue-admin-beautiful 
 *  copyright: chuzhixin 1204505056@qq.com 
 *  time: 2021-8-30 11:41:09
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46938ad2"],{"23df":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAMAAAAMCGV4AAAAkFBMVEVHcEyWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaWlpaaI0t5AAAAL3RSTlMA/gGnQTO2qr46xkoJUs2BpUl1CP3Or9gt+54n1jtpnMqP5ffmVsf4S6nEcbT86Yb9SSsAAABtSURBVAjXXclFEsIAAMDAVGlxd3fP/3/HAQodctsJANDr1Cm3sl3mbGKQlByp6Y/j/mgxNf96aMbSrGASuKar8cepzmlp9c1c3bJRawBkqseT2gyBWPUa3lQbxX7cn6oDYO+vHXCOKkWXA/+9AH/1DsFx9J7tAAAAAElFTkSuQmCC"},5015:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPBAMAAADJ+Ih5AAAAGFBMVEVHcEwBcvEBcvEBcvEBcvEBcvEBcvEBcvGZtdnYAAAAB3RSTlMAuzzLMC79DJRXcwAAADFJREFUCNdjYGBQLy9XYAACQfPyckMBIKMcBArQGOkYIlBGKQMrhFHCwIJLDW4GFAAA/zch6XBqaEgAAAAASUVORK5CYII="},"53ad":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"charge-monitor-tree_container"},[a("div",{staticClass:"left-tree"},[a("el-tree",{attrs:{data:e.treeData,props:e.treeProps,"node-key":"id",accordion:"","default-expanded-keys":e.expandData},on:{"node-expand":e.handleExpand,"node-click":e.handleNodeClick,"node-collapse":e.handleCollapse},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},["3"!==r.treeLevel?a("span",{style:e.treeNodeStyle(r)},[e._v(e._s(n.label))]):e._e(),["0","1"].includes(r.treeLevel)?[a("span",{style:e.treeNodeStyle(r)},[e._v("( "+e._s("0"===r.treeLevel?r.length:r.children.length)+" )")])]:e._e(),["2","3"].includes(r.treeLevel)?["2"===r.treeLevel?a("span",[e._v(" ( "+e._s(r.children.length)+" ) ")]):e._e(),e._l(r.devStatusList,(function(t,n){return a("span",{key:n},[a("span",{class:[e.countCircleClass(r.devStatusList[n].status),"default-circle"]},[e._v(" "+e._s(t.count)+" ")])])})),a("span",{staticClass:"span",style:e.treeNodeStyle(r)},[(e.$system.isCharging(r.status),a("span",[e._v(e._s(r.equipmentId))])),a("span",{style:e.statusIconStyle(r.status)},[a("img",{attrs:{src:e.statusIconSrc(r.status),alt:""}})])])]:e._e()],2)}}])})],1),a("div",{staticClass:"right-content"},[a("router-view",{key:e.$route.fullPath})],1)])},r=[],s=a("c964"),i=(a("d81d"),a("ac1f"),a("5319"),a("159b"),a("96cf"),a("a1fd")),o=a("2fae"),l=a("ed08"),d={data:function(){return{treeData:[],treeProps:{children:"children",label:"areaName"},expandData:[],intervalId:""}},created:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getTreeData();case 2:e.defaultExpand(),e.intervalId=window.setInterval((function(){e.getTreeData()}),o["intervalTime"]),e.$baseEventBus.$on("refreshEquipmentsList",e.getTreeData());case 5:case"end":return t.stop()}}),t)})))()},destroyed:function(){window.clearInterval(this.intervalId),this.$baseEventBus.$off("refreshEquipmentsList"),this.removeStationInfo()},methods:{getTreeData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["getStationAndDeviceTree"])();case 2:a=t.sent,n=a.data,null!==n&&void 0!==n&&n.length&&(e.treeData=n.map((function(e){var t;return e.length=0,null===(t=e.children)||void 0===t||t.map((function(t){var a;null!==(a=t.children)&&void 0!==a&&a.length&&(e.length+=t.children.length)})),e})),e.currentNodeId&&(r=e.findCurrentTreeData(e.treeData,e.currentNodeId),e.setStationInfo(r)));case 5:case"end":return t.stop()}}),t)})))()},defaultExpand:function(){if("{}"===JSON.stringify(this.$route.query)){var e=Object(l["deepClone"])(this.treeData[0]);this.expandData.push(e.id);var t=Object(l["deepClone"])(e.children);if(null!==t&&void 0!==t&&t.length){var a=t[0].id,n=t[0].children;this.expandData.push(a),null!==n&&void 0!==n&&n.length&&(this.setStationInfo(n[0]),this.expandData.push(n[0].id),this.currentNodeId=n[0].id)}}else{var r=this.$route.query,s=r.areaCode,i=r.orderNo,o=r.equipmentId,d=this.findCurrentTreeData(this.treeData,s,"areaCode");this.expandData=[s],d&&this.setStationInfo(d),i&&o&&s&&this.$router.replace({name:"monitor",query:{orderNo:i,equipmentId:o,areaCode:s}})}},handleCollapse:function(e){this.expandData=[e.parentId]},handleExpand:function(e){this.expandData=[e.id]},handleNodeClick:function(e){var t=e.treeLevel;return"1"===t?(this.currentNodeId=e.children[0].id,this.setStationInfo(e.children[0]),void this.$router.push({name:"realTime"})):"2"===t?(this.currentNodeId=e.id,this.setStationInfo(e),void this.$router.push({name:"realTime"})):"3"!==t?this.$router.push({name:"realTime"}):this.$system.isCharging(e.status)?this.$system.isValidValue(e.orderNo)?(window.sessionStorage.setItem("monitorInfo",JSON.stringify(e)),void this.$router.push({name:"monitor",query:{orderNo:e.orderNo,equipmentId:e.equipmentId}})):this.$message({message:"充电数据传输延时，请稍后查看。",type:"warning"}):this.$message({message:"请查看正在充电的设备",type:"warning"})},findCurrentTreeData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",n=null,r=function e(t,r){t.forEach((function(t){t[a]===r?n=t:t.children&&t.children.length&&e(t.children,r,a)}))};return r(e,t),n},setStationInfo:function(e){window.sessionStorage.setItem("stationName",e.areaName),window.sessionStorage.setItem("equipmentsList",JSON.stringify(e.children)),this.$baseEventBus.$emit("equipmentsListChange")},removeStationInfo:function(){window.sessionStorage.removeItem("stationName"),window.sessionStorage.removeItem("equipmentsListList")},statusIconStyle:function(e){var t=this.$system.getChargingColorStyle(e);return t.marginLeft="20px",t},statusIconSrc:function(e){return this.$system.isCharging(e)?a("61bd"):this.$system.isNoCharging(e)?a("5015"):e?a("23df"):void 0},treeNodeStyle:function(e){var t=e.treeLevel,a=e.status,n={fontWeight:"normal",color:"#333"};return"0"===t?n.color="#000":this.$system.isNoCharging(a)?n.color="#666":this.$system.isNetworkError(a)&&(n.color="#999"),n},countCircleClass:function(e){return this.$system.isCharging(e)?"charging-circle":this.$system.isNoCharging(e)?"no-charging-circle":e?"error-circle":void 0}}},c=d,u=(a("6e37"),a("2877")),p=Object(u["a"])(c,n,r,!1,null,"02c5880f",null);t["default"]=p.exports},"61bd":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAMAAADOvxanAAAAS1BMVEVHcEyRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHWRzHUlOhCzAAAAGHRSTlMAydlN/Dz4u8v+8tjsCdI3jpMCKxE1BpGZImvrAAAARklEQVQIHQXBBwKCQBAEsJG2h9Jt+f9LSZKMYExS1UCrCgACgIDlAYG5f0HgWAcI2u/6/BFs9d0HBLw7CDxPEJhmEAAEADfYWAxjt4iHewAAAABJRU5ErkJggg=="},"6e37":function(e,t,a){"use strict";a("f380")},a1fd:function(e,t,a){"use strict";a.r(t),a.d(t,"getStationAndDeviceTree",(function(){return r}));var n=a("b775");function r(e){return Object(n["default"])({url:"/api/v1/apps/monitor/getStationAndDeviceTree",method:"get",data:e})}},f380:function(e,t,a){}}]);